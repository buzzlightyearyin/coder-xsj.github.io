一、OSPF 多区域部署的方案
结合上述拓扑，OSPF 区域规划如下：
核心路由器和汇聚路由器之间所有链路部署在 AREA 0 骨干区域中，
汇聚路由器和接入路由器之间所有链路部署在 AREA 10 区域中，
汇聚路由器和接入路由器（AR7）之间所有链路部署在 AREA 20 区域中。
为了实现办公网络发生变化而不影响服务器所在区域路由器，可以通过如下方案解决：
方案一：特殊区域
将服务器所在区域配置为特殊区域，考虑到后续可能引入直连路由，建议配置为 Totally NSSA 区域。
配置特殊区域之后，所有域间明细路由、外部路由都无法进入 NSSA 区域，AR4 作为 ABR 下发默认路由用于指导本区域设备访问域间和域外。
由于服务器所在区域中，所有域间明细路由、外部路由都无法进入，所以本区域设备无法感知其他区域的路由变化。
AR3、AR4、AR7 配置为特殊区域：
ospf 1
    area 20
        nssa no-summary	// 配置为 Totally NSSA 区域

方案二：路由汇总
在 AR3、AR4 上对办公区域所在网络执行路由汇总，AR3、AR4 作为 ABR 只会将汇总后的路由传递进服务器所在区域，需要注意的是，确保汇总后的路由需要包含办公网络所有明细路由，因此需要考虑前期 IP 规划，建议手工配置或自动生成指向 NULL 的黑洞路由，以防路由汇总导致环路问题。
AR3、AR4 执行路由汇总：
ospf 1
    area 10
        abr-summary x.x.x.x y.y.y.y 	// x.x.x.x 为汇总后的 ip，y.y.y.y 为汇总后的掩码

以上两种方案都可以满足要求，后续还可以继续通过路由过滤和路由汇总进行相应的路由控制。

二、OSPF 多进程部署的方案
在 AR4 上部署 OSPF 多进程以实现办公网络和服务器网络的隔离，AR4 作为 ASBR 将服务器区域所在网络引入进办公区域中，考虑到办公网络发生变化而不影响服务器所在区域路由，AR4 在服务器所在区域通告默认路由指导设备访问域间和域外，而不必将服务器所在区域明细路由引入进服务器所在区域。
AR4 通告默认路由：
ospf 2			// 服务器区域所在进程
    default-route-advertise	// 通告默认路由

结合上述拓扑，需要 R1、R2 通过 OSPF 下发默认路由，缺省情况下 OSPF 下发的默认路由会以 LSA-5 的形式在除特殊区域以外的整个 AS 内泛洪。
此时可以通过如下方案进行选路：
方案一：修改外部路由类型
外部路由 LSA-5 通常有两种度量值类型：Type-1 和 Type-2，缺省情况下为 Type-2 类型，由于外部路由进行选路计算时 Type-1 类型会优于 Type-2 类型，为了使流量优选 R1，则可以在 R1 配置下发默认路由时修改优先级为 Type-1。
R1 修改外部路由类型：
ospf 1
    default-route-advertise type 1	// 通告默认路由并修改外部路由类型

方案二：修改路由开销值
1、修改外部开销值
默认情况下 OSPF 下发的默认路由会以类型为 Type-2 的 LSA-5 形式传递，Type-2 的 LSA-5 的路由进行比较时首先比较外部开销值，此时可以通过让 R2 发布默认路由时将外部开销值改大，从而实现流量优选 R1。
R2 修改外部开销值，配置如下：
ospf 1
    default-route-advertise cost 1000	// 通告默认路由并修改外部路由开销值
2、修改内部开销值
R1、R2 都通过相应命令下发默认路由，类型为 Type-2 的 LSA-5 进行选路比较：A、 首先会比较外部开销值、外部开销值默认为 1，B、其次比较内部开销值（去往 ASBR），建议修改核心路由器 AR2 与 汇聚路由器 AR4、汇聚路由器 AR4 和接入路由器 AR6 之间链路为较大值。
以 R2 为例，配置如下：
interface GigabitEthernet x/x/x
    ospf cost 1000

上述方案成功部署之后，可以满足所有业务流量通过 R1 访问外部，但是考虑到当前网络拓扑中 R2 设备自身会通过本地配置的的默认路由访问外部，为确保所有流量包括 R2 设备访问外部的流量都将 R1 作为出口，解决方案如下：
1、首先，R1 配置默认路由指向 ISP 并通过 OSPF 下发默认路由，由于 R2 也配置了上述命令以实现备份，所以缺省情况下 R2 不会使用 R1下发的 LSA-5 进行路由计算，所以需要 R2 配置命令允许计算 R1 下发的默认路由，具体配置如下：
ospf 1
    default-route-advertise permit-calculate-other		// 允许计算其他设备默认路由
2、其次，由于默认路由优先级为 60，要优于 OSPF 外部路由优先级为 150，所以 R2 修改之前指向 ISP 静态默认路由优先级为 151，配置如下：
ip route-static 0.0.0.0 0.0.0.0 x.x.x.x preference 151	// x.x.x.x 为 ISP 接口 ip

修改之后 R2 会优选 R1 通过 OSPF 下发默认路由，整个 OSPF 自治系统全部选择 R1 作为出口访问 ISP。
