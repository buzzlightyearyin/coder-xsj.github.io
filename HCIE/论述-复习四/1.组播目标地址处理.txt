问题一：
一、路由器收到目标地址为 224.0.0.5 的组播数据包的处理方式
组播目的地址 224.0.0.5 为 OSPF 协议预留地址，所有运行了 OSPF 协议的路由器都会监听相应的组播报文，当路由器收到目标地址为 224.0.0.5 的组播数据包（该协议号为 89），会上送 CPU 交由 OSPF 处理。
如果路由器未启用 OSPF 协议，则丢弃该报文；
如果路由器正确启用 OSPF 协议，则需要根据不同的网络类型处理不同的 OSPF 报文，情况如下：
1、点到点 P2P 类型
在该网络中，Hello、DD、LSR、LSU、LSAck 报文等报文的目标地址为 224.0.0.5。

2、广播 BoardCast 类型
在该网络中，Hello、LSU、LSAck 报文等报文的目标地址为 224.0.0.5。

3、点到多点 P2MP 类型
在该网络中，Hello 报文的目标地址为 224.0.0.5。

上述网络场景中，OSPF 收到不同的报文处理方式如下：
1、路由器收到 Hello 报文
会检查相应参数，参数协商失败则丢弃该报文，
参数协商成功，则继续通过 Active-Neighbor 字段建立双向通信的邻居关系，利用优先级、Router-id 完成 DR、BDR 的选举。
后续通过参数正确的 OSPF Hello 报文维系邻居关系并刷新超时计时器。

2、路由器收到 DD 报文
如果开启 MTU 检测则检测 MTU 是否一致，进一步选举主从关系保证 DD 可靠、有序交互，通过 LSA 头部信息完成链路状态数据库对比。

3、路由器收到 LSR 请求报文
收到的 LSR 请求报文会包含对方需要请求的 LSA 三要素，会回应 LSU 携带相应明细 LSA 信息进行更新。

4、路由器收到 LSU 更新报文
收到的 LSU 更新报文的目标地址为 224.0.0.5，需要通过 LSAck 报文进行确认。

5、路由器收到 LSAck 确认报文
报文中的 LSA 头部会确认之前发送的 LSU 报文是否更新成功，否则需要超时重传。

一、路由器收到目标地址为 239.0.0.5 的组播数据包的处理方式
组播目的地址 239.0.0.5 为本地管理组地址，通常为企业内部组播业务使用的组播地址，企业内部通常使用 IGMP 协议或者 PIM 协议作为组播路由协议，根据上述组播路由协议生成组播路由表项并下发到组播转发表，用于指导组播数据转发。

路由器收到组播数据包目标地址为 239.0.0.5 会检查是否存在相应转发表项，分情况如下：

一、路由器收到组播报文不存在相应组播转发表项
如果路由器收到组播报文不存在相应组播转发表项，会继续检查设备是否运行了 PIM 协议或者 IGMP 协议，
如果设备或者接口未运行组播协议，则丢弃该报文，
如果设备或者接口正确运行组播协议，则需要确定设备所处组播网络位置，分情况分析如下：

1、源端第一跳路由器收到目标地址为 239.0.0.5 的组播报文首先会进行 RPF 检测，RPF 检测失败则丢弃该报文，RPF 检测成功会借助 PIM 协议构建组播路由条目。
如果采用 PIM-DM 协议，则会将组播数据扩散至其它 PIM 邻居。、
如果采用 PIM-SM 协议，则会通过单播注册消息将（S，G）信息通知给 RP 汇聚点。

该路由器收到下游 Join 加入报文或者 Prune 剪枝报文之后会构建组播路由表的下游接口列表并下发到组播转发表。

2、中间路由器收到目标地址为 239.0.0.5 的组播报文首先会进行 RPF 检测，RPF 检测失败则丢弃该报文，RPF 检测成功会通过 PIM 协议构建组播路由条目。

该路由器收到下游 Join 加入报文或者 Prune 剪枝报文之后会构建组播路由表的下游接口列表并下发到组播转发表。

3、成员端最后一跳路由器通常会同时运行 PIM 以及 IGMP 协议
如果从上游接口接收到目的地址为 239.0.0.5 的组播报文首先会进行 RPF 检测，RPF 检测失败则丢弃该报文，RPF 检测成功会通过 PIM 协议构建组播路由条目。

如果从成员端接收到目的地址为 239.0.0.5 的组播报文，通常为 IGMP Report 消息，该路由器会创建成员关系记录表项以及组播路由表项。

最终，将 IGMP 和 PIM 路由表项下发到组播转发表。

RPF 检测的主要确定接收到组播数据的入接口与去往组播源的出接口一致，来防止组播数据的次优或者环路问题，RPF 检测失败则丢弃该报文。
其中组播静态、MBGP 组播动态、单播路由表都可以作为确定 RPF 接口的依据，而企业内部通常使用单播路由表作为确定 RPF 接口的主要依据。

二、路由器收到组播报文存在相应组播转发表项
考虑到路由器组播报文存在相应组播转发表项，为了减轻设备负担，无需针对每一份组播报文都进行 RPF 检测。

1、源端第一跳路由器和中间路由器收到目标地址为 239.0.0.5 的组播报文，首先会判断接收到组播报文的接口与组播（S，G）转发表项上游接口是否一致，如果一致，则会通过组播转发表向着下游接口列表转发该报文，如果不一致，才需要进行 RPF 检测。

（1）如果通过 RPF 选举的 RPF 接口与当前组播（S，G）转发表项上游接口一致，则说明 RPF 检测失败，直接丢弃该报文。

（2）如果通过 RPF 选举的 RPF 接口与当前组播（S，G）转发表项上游接口不一致，则说明当前组播（S，G）转发表项上游接口需要更新，并按照更新后的 RPF 接口重新对该组播报文进行 RPF 检测，RPF 检测失败则丢弃该报文，RPF 检测成功会通过组播转发表向着下游接口列表转发该报文。

2、成员端最后一跳路由器如果从成员端接口接收到目标地址为 239.0.0.5 的组播报文，通常为 IGMP Report 消息，则会刷新表项计时器。