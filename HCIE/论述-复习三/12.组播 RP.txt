问题一：
结合上述拓扑，考虑到存在 RP 的场景，因此运行的组播路由协议为 PIM-SM 协议，且组播模型为 ASM 任意源模型。
1、采用 PIM-SM 和 IGMPv1 组合
  1、2、3 号接口都需要同时开启 PIM-SM 和 IGMP 协议。
  PIM-SM 协议用于 IGMPv1 查询器的选举，PIM DR 选举，组播 RPT 树建立，IGMP 用于处理加组报告，维护组成员关系。

2、采用 PIM-SM 和 IGMPv2 组合
  1、2 号接口都需要同时开启 PIM-SM 和 IGMP 协议，3 号接口仅需要开启 IGMP 协议。
  PIM-SM 协议用于 PIM DR 选举，组播 RPT 树建立，IGMP 用于处理加组报告，维护组成员关系。
  需要注意的是如果 3 号接口以后连接 MA 网络，存在多台路由器的可能则必须开启 PIM-SM 协议。

3、采用 PIM IPv6 SM 和 MLD 组合
  1、2 号接口都需要同时开启 PIM IPv6 SM 和 MLD 协议，3 号接口仅需要开启 MLD 协议。
  PIM IPv6 SM 协议用于 PIM IPv6 DR 选举，组播 RPT 树建立，MLD 用于处理加组报告，维护组成员关系。

针对部分主机不支持 IGMP 协议或希望进行快速转发组播数据的场景，接口也可以配置 IGMP 静态加组或 MLD 静态加组。

问题二：
在大型 PIM-SM 组播网络中，汇聚点 RP 为组播网络中一台重要的 PIM 路由器，因此需要保证可靠性。
考虑到网络规模较大，静态 RP 的部署需要在网络中所有 PIM 路由器上都配置相同的 RP 地址但是由于静态 RP 配置量较大，且无法感知到拓扑变化，所以不适用于大型网络拓扑，此处考虑通过 BSR 动态选举 RP 保证可靠性的同时并且降低 RP 负担。
我们可以从如下几个方案进行解决：
方案一：配置多台 C-RP 并指定不同服务组地址范围
在上述拓扑场景中，将部分路由器配置为 C-RP，同时配置多台 C-BSR，保证 C-BSR 和 C-RP 都不会出现单点故障问题。
可以继续配置不同 C-RP 服务于不同组播组地址范围，实现不同组播地址选择不同的 RP，降低单一 RP 的负担，相应配置如下：
假设 R2 的服务组地址范围为 239.1.1.0/24
acl 2000
    rule permit source 239.1.1.0 0.0.0.255
pim-sm
    c-rp LoopBack 0 group-policy 2000
假设 R3 的服务组地址范围为 239.1.2.0/24
acl 2001
    rule permit source 239.1.2.0 0.0.0.255
pim-sm
    c-rp LoopBack 0 group-policy 2001

通过上述配置后，组播地址为 239.1.1.0/24 的业务会选择 R2 作为 RP，组播地址为 239.1.2.0/24 的业务会选择 R3 作为 RP，保证可靠性的同时降低 RP 负担。

方案二：保证开启组成员端 DR 触发切换
华为设备默认情况下组成员端 DR 收到第一个组播数据包之后立即进行 SPT 切换，切换之后组播流量会通过最优路径经由 SPT 源树从组播源转发至组成员。
这种情况下，可以允许组播流量不经由 RPT 共享树，降低 RP 的组播流量转发负担，需要注意的是保证开启触发切换，不能配置永不切换，相应配置如下：
[R2-pim]spt-switch-threshold ?
dddd
xxxx

方案三：配置 Anycast RP
上文介绍的 RP 方案中，每个组播组都只能映射到一个 RP，当网络流量较大，负担较重，可能导致 RP 压力过大，RP 失效后路由收敛较慢。
可以通过应用基于 PIM 协议的 Anycast RP，实现组播源端 DR 就近注册和组成员端 DR 就近加入，可以缓解单个 RP 的负担，也实现了 RP 备份。
假设 R2 和 R3 都配置了环回口，配置相同的地址 10.10.1.1/24 作为 Anycast RP，通过底层 IGP 保证环回口可达，相应 Anycast RP 配置如下：
以 R2 为例：
pim
c-rp LoopBack0
c-bsr LoopBack0
anycast-rp 10.10.1.1
    local-address 2.2.2.2
    peer 3.3.3.3



